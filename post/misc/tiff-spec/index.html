<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>TIFF6.0格式简介 - chai2010 的博客</title>
  <link rel="alternate" hreflang="zh-CN" href="https://chai2010.cn/" />

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="chai2010" />
  <meta name="description" content="作者: chai2010 (chaishushan{AT}gmail.com) (整理) 标签图像文件格式(Tagged Image File Format, 简写为TIFF)是一种主要用来存储包括照片和艺术图在内的图像的文件格式. 它最初由Ald" />

  <meta name="keywords" content="chai2010, Go, Golang" />






<meta name="generator" content="Hugo 0.30.2" />


<link rel="canonical" href="https://chai2010.cn/post/misc/tiff-spec/" />

<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" href="/favicon.ico" />
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">




<link href="/dist/jane.min.css?v=2.7.0" rel="stylesheet">


<meta property="og:title" content="TIFF6.0格式简介" />
<meta property="og:description" content="作者: chai2010 (chaishushan{AT}gmail.com) (整理) 标签图像文件格式(Tagged Image File Format, 简写为TIFF)是一种主要用来存储包括照片和艺术图在内的图像的文件格式. 它最初由Ald" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://chai2010.cn/post/misc/tiff-spec/" />



<meta property="article:published_time" content="2013-09-02T00:00:00&#43;00:00"/>

<meta property="article:modified_time" content="2013-09-02T00:00:00&#43;00:00"/>











<meta itemprop="name" content="TIFF6.0格式简介">
<meta itemprop="description" content="作者: chai2010 (chaishushan{AT}gmail.com) (整理) 标签图像文件格式(Tagged Image File Format, 简写为TIFF)是一种主要用来存储包括照片和艺术图在内的图像的文件格式. 它最初由Ald">


<meta itemprop="datePublished" content="2013-09-02T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2013-09-02T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="1862">



<meta itemprop="keywords" content="tiff," />
<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="TIFF6.0格式简介"/>
<meta name="twitter:description" content="作者: chai2010 (chaishushan{AT}gmail.com) (整理) 标签图像文件格式(Tagged Image File Format, 简写为TIFF)是一种主要用来存储包括照片和艺术图在内的图像的文件格式. 它最初由Ald"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->


<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-621845-14', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">chai2010 的博客</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">主页</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">全部文章</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">标签</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">分类</li>
      </a><a href="/talks/">
        <li class="mobile-menu-item">报告</li>
      </a><a href="/books/">
        <li class="mobile-menu-item">图书</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">关于</li>
      </a>
  </ul>
</nav>

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">chai2010 的博客</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">主页</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">全部文章</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">标签</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">分类</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/talks/">报告</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/books/">图书</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">关于</a>
      </li>
  </ul>
</nav>
  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">TIFF6.0格式简介</h1>

      <div class="post-meta">
        <span class="post-time"> 2013-09-02 </span>
        <div class="post-category">
            
              <a href="/categories/misc/"> misc </a>
            
          </div>
        <span class="more-meta"> 约 1862 字 </span>
        <span class="more-meta"> 预计阅读 4 分钟 </span>
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#结构概述">结构概述</a></li>
<li><a href="#图像基本信息">图像基本信息</a></li>
<li><a href="#色彩模型">色彩模型</a>
<ul>
<li><a href="#二值图像">二值图像</a></li>
<li><a href="#灰度图像">灰度图像</a></li>
<li><a href="#调色板图像">调色板图像</a></li>
<li><a href="#真彩色图像">真彩色图像</a></li>
<li><a href="#其他模型">其他模型</a></li>
</ul></li>
<li><a href="#条带和分片">条带和分片</a></li>
<li><a href="#位平面">位平面</a></li>
<li><a href="#压缩方式">压缩方式</a></li>
<li><a href="#常见标签">常见标签</a></li>
<li><a href="#空闲空间">空闲空间</a></li>
<li><a href="#忽略特性">忽略特性</a></li>
<li><a href="#文件实例">文件实例</a></li>
<li><a href="#参考信息">参考信息</a></li>
</ul></li>
</ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      

<!-- TIFF格式简介 -->

<!-- 作者: chai2010 chaishushan{AT}gmail.com (整理) -->

<p><em>作者: chai2010 (chaishushan{AT}gmail.com) (整理)</em></p>

<p>标签图像文件格式(Tagged Image File Format, 简写为TIFF)是一种主要用来存储包括照片和艺术图在内的图像的文件格式. 它最初由Aldus公司与微软公司一起为PostScript打印开发.</p>

<p>TIFF最初的设计目的是为了1980年代中期桌面扫描仪厂商达成一个公用的扫描图像文件格式, 而不是每个厂商使用自己专有的格式. 在刚开始的时候, TIFF只是一个二值图像格式, 因为当时的桌面扫描仪只能处理这种格式. 随着扫描仪的功能愈来愈强大, 并且桌面计算机的磁盘空间越来越大, TIFF逐渐支持灰阶图像和彩色图像.</p>

<p>目前最新的 <a href="http://partners.adobe.com/public/developer/en/tiff/TIFF6.pdf">TIFF6.0规范</a> 在1992年公布.</p>

<h2 id="结构概述">结构概述</h2>

<p>TIFF文件以<code>.tif</code>或<code>.tiff</code>为扩展名. 其数据格式是一种3级体系结构, 从高到低依次为: 文件头IFH(Image File Header), 一个或多个称为IFD(Image File Directory)的包含标记指针的目录和数据. 一个文件中可以包含多个IFD, 每个IFD对应一个图像.</p>

<p>图像头(IFH)/图像目录(IFD)/标签入口(IFDEntry)的逻辑结构如下:</p>

<pre><code>+------------------------------------------------------------------------------+
|                           TIFF Structure                                     |
|  IFH                                                                         |
| +------------------+                                                         |
| | II/MM            |                                                         |
| +------------------+                                                         |
| | 42               |      IFD                                                |
| +------------------+    +------------------+                                 |
| | Next IFD Address |---&gt;| IFD Entry Num    |                                 |
| +------------------+    +------------------+                                 |
|                         | IFD Entry 1      |                                 |
|                         +------------------+                                 |
|                         | IFD Entry 2      |                                 |
|                         +------------------+                                 |
|                         |                  |      IFD                        |
|                         +------------------+    +------------------+         |
|     IFD Entry           | Next IFD Address |---&gt;| IFD Entry Num    |         |
|    +---------+           +------------------+   +------------------+         |
|    | Tag     |                                  | IFD Entry 1      |         |
|    +---------+                                  +------------------+         |
|    | Type    |                                  | IFD Entry 2      |         |
|    +---------+                                  +------------------+         |
|    | Count   |                                  |                  |         |
|    +---------+                                  +------------------+         |
|    | Offset  |---&gt;Value                         | Next IFD Address |---&gt;NULL |
|    +---------+                                  +------------------+         |
|                                                                              |
+------------------------------------------------------------------------------+
</code></pre>

<p>其中, TIFF中的版本号为42, 包含生命宇宙以及任何事情的终极答案(这也说明了TIFF格式为何这么强大).
文件中的数据指针(offset)最大对应4个字节, 因此一个文件不能超过4GB.
如果需要大于4GB的图像支持, 可以参考基于TIFF的变种格式 <a href="http://www.awaresystems.be/imaging/tiff/bigtiff.html">BigTiff</a>.</p>

<h2 id="图像基本信息">图像基本信息</h2>

<p>基本信息为图像的大小, 图像的颜色模型(黑白图像/灰度图像/调色板图像/真彩色 等),
每个像素的大小和单位等信息.</p>

<p>每个图像必须包含的标签有(含压缩类型):</p>

<pre><code>ImageWidth 256 SHORT or LONG
ImageLength 257 SHORT or LONG
XResolution 282 RATIONAL
YResolution 283 RATIONAL
ResolutionUnit 128 SHORT 1, 2 or 3
Compression 259 SHORT 1, 2 or 32773
</code></pre>

<p>其中颜色模型由几个标签组合判断:</p>

<pre><code>PhotometricInterpretation 262 106 SHORT 0/1/2/3
BitsPerSample 258 SHORT 4 or 8
SamplesPerPixel 277 SHORT default(1)
ColorMap 320 SHORT 3 * (2**BitsPerSample)
</code></pre>

<h2 id="色彩模型">色彩模型</h2>

<p>TIFF基础部分定义了4种色彩模型(这里不讨论掩码图像和扩展色彩模型),
主要有: 二值图像, 灰度图像, 调色板图像, 真彩色图像.</p>

<h3 id="二值图像">二值图像</h3>

<ol>
<li>如果没有 BitsPerSample 则为二值图</li>
<li>颜色模型 PhotometricInterpretation 必须为 0(0为白色) 或 1(1为白色)</li>
<li>压缩类型 Compression 1, 2 or 32773, 支持 Huffman 编码</li>
</ol>

<h3 id="灰度图像">灰度图像</h3>

<ol>
<li>有 BitsPerSample, 且 PhotometricInterpretation 为 0 或 1</li>
<li>压缩类型 Compression 1 or 32773, 不支持 Huffman 编码</li>
</ol>

<h3 id="调色板图像">调色板图像</h3>

<ol>
<li>PhotometricInterpretation 为 3</li>
<li>必需包含 ColorMap</li>
<li>BitsPerSample 为 4 或 8</li>
<li>Compression 为 1 or 32773, 不支持 Huffman 编码</li>
</ol>

<h3 id="真彩色图像">真彩色图像</h3>

<ol>
<li>PhotometricInterpretation 为 2</li>
<li>必须含 SamplesPerPixel 波段数信息, 值为 3</li>
<li>BitsPerSample 必须为 8,8,8</li>
<li>Compression 为 1 or 32773, 不支持 Huffman 编码</li>
</ol>

<h3 id="其他模型">其他模型</h3>

<p>TIFF 的扩展特性中还包含 CMYK 和 YCbCr 等其他色彩模型.
详细信息请参考TIFF6.0规范.</p>

<h2 id="条带和分片">条带和分片</h2>

<p>其中数据的组织方式有条带和分片两种, 默认为条带方式存储.</p>

<p>条带图像必要的标签有:</p>

<pre><code>RowsPerStrip 278 SHORT or LONG
StripOffsets 273 SHORT or LONG
StripByteCounts 279 SHORT or LONG
</code></pre>

<p>其中 <code>RowsPerStrip</code> 缺省值为 <code>2^32-1</code>, 图像将只有1个条带.
如果条带数据不足的话, 末尾并不需要数据填充.</p>

<p>分片图像必要的标签有:</p>

<pre><code>TileWidth 322 SHORT or LONG
TileLength 323 SHORT or LONG
TileOffsets 324 SHORT or LONG
TileByteCounts 325 SHORT or LONG
</code></pre>

<p>每个片的大小必须是16的倍数, 每个片的长和宽可以不同.
如果片数据不足的话, 需要填充(填充数据没有要求).</p>

<h2 id="位平面">位平面</h2>

<p>位平面由 <code>PlanarConfiguration</code> 标签确定, 缺省时为1表示按像素组织(比如RGBRGB).
当 <code>PlanarConfiguration</code> 为2时, 为按通道存储(比如RRGGBB).</p>

<p>当只有1个通道时(<code>SamplesPerPixel</code>), 位平面信息可以忽略.</p>

<h2 id="压缩方式">压缩方式</h2>

<p>压缩方式由 <code>Compression</code> 标签确定.</p>

<p>基本算法:</p>

<pre><code>1 = No compression
2 = CCITT modified Huffman RLE
32773 = PackBits compression, aka Macintosh RLE
</code></pre>

<p>扩展特性:</p>

<pre><code>3 = CCITT Group 3 fax encoding
4 = CCITT Group 4 fax encoding
5 = LZW
6 = JPEG ('old-style' JPEG, later overriden in Technote2)
7 = JPEG ('new-style' JPEG)
8 = Deflate ('Adobe-style')
</code></pre>

<h2 id="常见标签">常见标签</h2>

<pre><code>ImageDescription 270 ASCII

CellLength 265 SHORT
CellWidth 264 SHORT

Software 305 ASCII
DateTime 306 ASCII
Artist 315 ASCII
HostComputer 316 ASCII

Copyright 33432 ASCII
</code></pre>

<h2 id="空闲空间">空闲空间</h2>

<p>当创建或更新TIFF文件时, 文件中会有一些空闲的空间(类似malloc/free导致的内存碎片).
TIFF规范中有 <code>FreeByteCounts</code> 和 <code>FreeOffsets</code> 两个标签用于记录文件中的空闲空间.</p>

<p>但是由于不同标签之间的弱引用关系, <code>FreeByteCounts</code> 和 <code>FreeOffsets</code> 记录的信息
可能并不可靠. 因此, 并不能完全依赖这个信息.</p>

<h2 id="忽略特性">忽略特性</h2>

<ul>
<li>文件中含多个图像(多IFD)</li>
<li>扩展的压缩算法</li>
<li>扩展的色彩模型</li>
<li>多通道数大于4</li>
</ul>

<h2 id="文件实例">文件实例</h2>

<p>这是一个二值图像的片段(来自TIFF6.0规范文档):</p>

<pre><code>Header:
0000 Byte Order                  4D4D
0002 42                          002A
0004 1st IFD offset              00000014

IFD:
0014 Number of Directory Entries 000C
0016 NewSubfileType              00FE 0004 00000001 00000000
0022 ImageWidth                  0100 0004 00000001 000007D0
002E ImageLength                 0101 0004 00000001 00000BB8
003A Compression                 0103 0003 00000001 8005 0000
0046 PhotometricInterpretation   0106 0003 00000001 0001 0000
0052 StripOffsets                0111 0004 000000BC 000000B6
005E RowsPerStrip                0116 0004 00000001 00000010
006A StripByteCounts             0117 0003 000000BC 000003A6
0076 XResolution                 011A 0005 00000001 00000696
0082 YResolution                 011B 0005 00000001 0000069E
008E Software                    0131 0002 0000000E 000006A6
009A DateTime                    0132 0002 00000014 000006B6
00A6 Next IFD offset             00000000

Values longer than 4 bytes:
00B6 StripOffsets                Offset0, Offset1, ... Offset187
03A6 StripByteCounts             Count0, Count1, ... Count187
0696 XResolution                 0000012C 00000001
069E YResolution                 0000012C 00000001
06A6 Software                    “PageMaker 4.0”
06B6 DateTime                    “1988:02:18 13:59:59”

Image Data:
00000700                         Compressed data for strip 10
xxxxxxxx                         Compressed data for strip 179
xxxxxxxx                         Compressed data for strip 53
xxxxxxxx                         Compressed data for strip 160
</code></pre>

<h2 id="参考信息">参考信息</h2>

<ul>
<li><a href="http://partners.adobe.com/public/developer/en/tiff/TIFF6.pdf">http://partners.adobe.com/public/developer/en/tiff/TIFF6.pdf</a></li>
<li><a href="http://www.awaresystems.be/imaging/tiff.html">http://www.awaresystems.be/imaging/tiff.html</a></li>
<li><a href="http://www.libtiff.org/tools.html">http://www.libtiff.org/tools.html</a></li>
</ul>

    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">chai2010</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">2013-09-02</span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>

    
    

    <footer class="post-footer">
      <div class="post-tags">
          
          <a href="/tags/tiff/">tiff</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/golang/go1_2/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Go1.2新功能简介</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        
          <a class="next" href="/post/golang/go-benchmark-pk-joke/">
            <span class="next-text nav-default">系统级编程语言性能大PK的笑话-Go语言</span>
            <span class="prev-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>

    <script src="https://giscus.app/client.js"
    data-repo="chai2010/chai2010.github.io"
    data-repo-id="MDEwOlJlcG9zaXRvcnkxMjQxNjY5MDk="
    data-category="General"
    data-category-id="DIC_kwDOB2ai_c4CR3mk"
    data-mapping="og:title"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="bottom"
    data-theme="light"
    data-lang="en"
    data-loading="lazy"
    crossorigin="anonymous"
    async>
  </script>
  </article>
        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  
</div>

<div class="copyright">
  

  <span class="copyright-year">
    &copy;
    
      2006 -
    2022
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">chai2010</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
<script src="/lib/highlight/highlight.pack.js?v=20171001"></script>
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>
  
<script type="text/javascript" src="/dist/jane.min.js?v=2.7.0"></script>


</body>
</html>
